services:
  freedify:
    # Option 1: Use pre-built image from Docker Hub (recommended)
    image: biohaphazard/freedify:latest
    # Option 2: Build from source (uncomment below, comment out image above)
    # build: .
    container_name: freedify
    ports:
      - "8000:8000"
    environment:
      - PORT=8000
      - MP3_BITRATE=320k
      # Optional - Timezone (for NAS users)
      # - TZ=America/New_York
      # Optional - User/Group ID for file permissions (Synology/NAS)
      # - PUID=1000
      # - PGID=1000
      # Optional - Hi-Res Audio (get from dabmusic.xyz cookies)
      # - DAB_SESSION=your_session_cookie
      # - DAB_VISITOR_ID=your_visitor_id
      # Optional - AI Features (get from aistudio.google.com)
      # - GEMINI_API_KEY=your_api_key
      # Optional - Lyrics
      # - GENIUS_ACCESS_TOKEN=your_token
      # Optional - ListenBrainz scrobbling
      # - LISTENBRAINZ_TOKEN=your_token
      # Optional - Podcasts (falls back to iTunes if not set)
      # - PODCASTINDEX_KEY=your_key
      # - PODCASTINDEX_SECRET=your_secret
    volumes:
      # Persist cache for faster repeated plays
      - freedify-cache:/app/cache
      # For NAS users with custom paths, use:
      # - /your/nas/path/freedify-cache:/app/cache
    restart: unless-stopped
    healthcheck:
      test: [ "CMD", "python", "-c", "import httpx; httpx.get('http://localhost:8000/api/health')" ]
      interval: 30s
      timeout: 10s
      retries: 3

volumes:
  freedify-cache:
